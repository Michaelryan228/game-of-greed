Credit to Davee Sok for calculate score function